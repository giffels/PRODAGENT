
# Define a job to test some features of a repacker executable.
# Note that this is in many ways trivial compared to what the
# final repacker executable will need to be.

# This reads a single streamer file as input and then outputs
# 50 files using 50 PoolOutputModules.  Each output module
# selects events based on a bit in the triggerResults object
# in the input file.

# Original author   W. David Dagenhart   29 March 2007

process REPACKER = {

  untracked PSet configurationMetadata = {
        untracked string version = "$Revision: 1.1 $"
        untracked string name = "$Source: /cvs/CMSSW/COMP/PRODAGENT/src/python/RepackerInjector/test/testRepacker_50streams.cfg"
        untracked string annotation = "configuration template for RepackerInjector"
    }

  include "FWCore/MessageLogger/data/MessageLogger.cfi"
  untracked PSet options = 
  {
    untracked vstring Rethrow = { "ProductNotFound", "TooManyProducts", "TooFewProducts" }
  }

  #service = Timing { }

  source = NewEventStreamFileReader
  {
    untracked vstring fileNames = {
      'testRandomFilter.dat'
    }
    int32 max_event_size = 7000000
    int32 max_queue_depth = 5
  }
  
  module out1 = PoolOutputModule
  {
    untracked string fileName = "p1.root"
    untracked int32 compressionLevel = 1
    untracked PSet SelectEvents = {
      vstring SelectEvents = { "p1:HLT" }
    }
    untracked PSet dataset = {
        untracked string dataTier = "RAW"
	untracked string filterName = "stream1"
    }
  }

  module out2 = PoolOutputModule
  {
    untracked string fileName = "p2.root"
    untracked int32 compressionLevel = 1
    untracked PSet SelectEvents = {
      vstring SelectEvents = { "p2:HLT" }
    }
    untracked PSet dataset = {
        untracked string dataTier = "RAW"
	untracked string filterName = "stream2"
    }
  }

  module out3 = PoolOutputModule
  {
    untracked string fileName = "p3.root"
    untracked int32 compressionLevel = 1
    untracked PSet SelectEvents = {
      vstring SelectEvents = { "p3:HLT" }
    }
    untracked PSet dataset = {
        untracked string dataTier = "RAW"
	untracked string filterName = "stream3"
    }
  }

  module out4 = PoolOutputModule
  {
    untracked string fileName = "p4.root"
    untracked int32 compressionLevel = 1
    untracked PSet SelectEvents = {
      vstring SelectEvents = { "p4:HLT" }
    }
    untracked PSet dataset = {
        untracked string dataTier = "RAW"
	untracked string filterName = "stream4"
    }
  }

  module out5 = PoolOutputModule
  {
    untracked string fileName = "p5.root"
    untracked int32 compressionLevel = 1
    untracked PSet SelectEvents = {
      vstring SelectEvents = { "p5:HLT" }
    }
    untracked PSet dataset = {
        untracked string dataTier = "RAW"
	untracked string filterName = "stream5"
    }
  }

  module out6 = PoolOutputModule
  {
    untracked string fileName = "p6.root"
    untracked int32 compressionLevel = 1
    untracked PSet SelectEvents = {
      vstring SelectEvents = { "p6:HLT" }
    }
    untracked PSet dataset = {
        untracked string dataTier = "RAW"
	untracked string filterName = "stream6"
    }
  }

  module out7 = PoolOutputModule
  {
    untracked string fileName = "p7.root"
    untracked int32 compressionLevel = 1
    untracked PSet SelectEvents = {
      vstring SelectEvents = { "p7:HLT" }
    }
    untracked PSet dataset = {
        untracked string dataTier = "RAW"
	untracked string filterName = "stream7"
    }
  }

  module out8 = PoolOutputModule
  {
    untracked string fileName = "p8.root"
    untracked int32 compressionLevel = 1
    untracked PSet SelectEvents = {
      vstring SelectEvents = { "p8:HLT" }
    }
    untracked PSet dataset = {
        untracked string dataTier = "RAW"
	untracked string filterName = "stream8"
    }
  }

  module out9 = PoolOutputModule
  {
    untracked string fileName = "p9.root"
    untracked int32 compressionLevel = 1
    untracked PSet SelectEvents = {
      vstring SelectEvents = { "p9:HLT" }
    }
    untracked PSet dataset = {
        untracked string dataTier = "RAW"
	untracked string filterName = "stream9"
    }
  }

  module out10 = PoolOutputModule
  {
    untracked string fileName = "p10.root"
    untracked int32 compressionLevel = 1
    untracked PSet SelectEvents = {
      vstring SelectEvents = { "p10:HLT" }
    }
    untracked PSet dataset = {
        untracked string dataTier = "RAW"
	untracked string filterName = "stream10"
    }
  }

  endpath o = { out1 &
                out2 &
                out3 &
                out4 &
                out5 &
                out6 &
                out7 &
                out8 &
                out9 &
                out10
              }
}
